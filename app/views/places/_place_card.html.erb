<% @places.each do |place| %>
  <div class="product">
    <div class='product-upvote'>
      <div class="product-arrow"></div>
      <div class='product-count'><%= place.id %></div>
    </div>

      <%= cl_image_tag place.place_photo, height: 150, width: 200, crop: :fill %>

    <div class='product-body'>
        <h3><%= link_to place.place_name, place_path(place), {class: "btn btn-primary"} %></h3>
        <p><%= place.place_address %></p>
        <p><%= place.place_category %></p>
        <p><%= place.capacity %></p>
    </div>
    <ul class="list-inline product-controls hidden-sm hidden-xs">
      <li><a href=""><i class="fa fa-heart"></i></a></li>
      <li><a href=""><i class="fa fa-share"></i></a></li>
      <li><a href=""><i class="fa fa-star"></i></a></li>
      <li><div class="situation">
          <div id="map" style="width: 150px; height: 150px"></div>

          <% content_for(:after_js) do %>
            <%= javascript_tag do %>
              $(document).ready(function() {
                var handler = Gmaps.build('Google');
                handler.buildMap({ internal: { id: 'map' } }, function() {
                  markers = handler.addMarkers(<%= raw @hash.to_json %>);
                  handler.bounds.extendWith(markers);
                  handler.fitMapToBounds();
                  if (markers.length == 0) {
                    handler.getMap().setZoom(2);
                  } else if (markers.length == 1) {
                    handler.getMap().setZoom(14);
                  }
                });
              });
            <% end %>
          <% end %>

        </div>
      </li>
    </ul>
  </div>
<% end %>

